"use strict";(this.webpackChunktweb=this.webpackChunktweb||[]).push([[810],{810:(e,t,n)=>{n.r(t),n.d(t,{default:()=>j});var a=n(6858),o=n(8805),i=n(4687),s=n(9518),c=n(8598),r=n(4874),d=n(503),l=n(9807),u=n(4494),p=n(4789),h=n(5432),m=n(4159),g=n(4727),f=n(2897),v=n(1405),y=n(4668),L=n(8497),E=n(144),b=n(6947),Z=n(8576),_=n(4465),w=n(9638),k=n(3910),S=n(2738),T=n(5565),x=n(1656),C=n(7487),N=n(2398),P=n(671),I=n(6669),A=n(7922),D=n(3512),M=n(709),O=n(9976);let B,H=null;const R=new r.Z("page-sign",!0,(()=>{const e=()=>{t=g.default.countriesList.filter((e=>{var t;return!(null===(t=e.pFlags)||void 0===t?void 0:t.hidden)})).sort(((e,t)=>(e.name||e.default_name).localeCompare(t.name||t.default_name)))};let t;e(),D.default.addEventListener("language_change",(()=>{e()}));const r=new Map;let v,j;const U=document.createElement("div");U.classList.add("input-wrapper");const W=new d.Z({label:"Login.CountrySelectorLabel",name:(0,E.a)()});W.container.classList.add("input-select");const q=W.input,F=document.createElement("div");F.classList.add("select-wrapper","z-depth-3","hide");const K=document.createElement("span");K.classList.add("arrow","arrow-down"),W.container.append(K);const V=document.createElement("ul");F.appendChild(V),new o.ZP(F);let z=()=>{z=null,t.forEach((e=>{const t=(0,P.Ml)(e.iso2),n=[];e.country_codes.forEach((a=>{const o=document.createElement("li");let i=c.o.wrapEmojiText(t);if(O.Z){const e=document.createElement("span");e.innerHTML=i,o.append(e)}else o.innerHTML=i;const s=(0,g.i18n)(e.default_name);s.dataset.defaultName=e.default_name,o.append(s);const r=document.createElement("span");r.classList.add("phone-code"),r.innerText="+"+a.country_code,o.appendChild(r),n.push(o),V.append(o)})),r.set(e.iso2,n)})),V.addEventListener("mousedown",(e=>{if(0!==e.button)return;const t=(0,y.Z)(e.target,"LI");Q(t)})),W.container.appendChild(F)};const Q=e=>{const n=e.childNodes[1].dataset.defaultName,a=e.querySelector(".phone-code").innerText,o=a.replace(/\D/g,"");(0,T.Z)(q,(0,g.i18n)(n)),(0,I.Z)(q,"input"),v=t.find((e=>e.default_name===n)),j=v.country_codes.find((e=>e.country_code===o)),Y.value=Y.lastValue=a,X(),setTimeout((()=>{ee.focus(),(0,N.Z)(ee,!0)}),0)};let $;z(),q.addEventListener("focus",(function(e){z?z():t.forEach((e=>{r.get(e.iso2).forEach((e=>e.style.display=""))})),clearTimeout($),$=void 0,F.classList.remove("hide"),F.offsetWidth,F.classList.add("active"),W.select(),(0,p.Z)({container:R.pageEl.parentElement.parentElement,element:q,position:"start",margin:4}),setTimeout((()=>{G||(document.addEventListener("mousedown",J,{capture:!0}),G=!0)}),0)}));let G=!1;const J=e=>{(0,L.Z)(e.target,"input-select")||e.target!==q&&(X(),document.removeEventListener("mousedown",J,{capture:!0}),G=!1)},X=()=>{void 0===$&&(F.classList.remove("active"),$=window.setTimeout((()=>{F.classList.add("hide"),$=void 0}),200))};q.addEventListener("keyup",(e=>{const n=e.key;if(e.ctrlKey||"Control"===n)return!1;let a=W.value.toLowerCase(),o=[];t.forEach((e=>{const t=[e.name,e.default_name,e.iso2];t.filter(Boolean).forEach((e=>{const n=e.split(" ").filter((e=>/\w/.test(e))).map((e=>e[0])).join("");n.length>1&&t.push(n)}));let n=!!t.filter(Boolean).find((e=>-1!==e.toLowerCase().indexOf(a)));r.get(e.iso2).forEach((e=>e.style.display=n?"":"none")),n&&o.push(e)})),0===o.length?t.forEach((e=>{r.get(e.iso2).forEach((e=>e.style.display=""))})):1===o.length&&"Enter"===n&&Q(r.get(o[0].iso2)[0])})),K.addEventListener("mousedown",(function(e){e.cancelBubble=!0,e.preventDefault(),q.matches(":focus")?q.blur():q.focus()}));const Y=new M.Z({onInput:e=>{f.Z.loadLottieWorkers();const{country:t,code:n}=e||{};let a=t?t.name||t.default_name:"";a===W.value||v&&t&&n&&(v===t||j.country_code===n.country_code)||((0,T.Z)(q,t?(0,g.i18n)(t.default_name):a),v=t,j=n),t||Y.value.length-1>1?H.style.visibility="":H.style.visibility="hidden"}}),ee=Y.input;ee.addEventListener("keypress",(e=>{if(!H.style.visibility&&"Enter"===e.key)return ne()}));const te=new l.Z({text:"Login.KeepSigned",name:"keepSession",withRipple:!0,checked:!0});te.input.addEventListener("change",(()=>{const e=te.checked;i.default.pushToState("keepSigned",e),b.Z.toggleStorage(e),Z.Z.toggleStorage(e),s.Z.toggleStorage(e),C.Z.toggleStorage(e)})),i.default.getState().then((e=>{i.default.storage.isAvailable()?te.checked=e.keepSigned:(te.checked=!1,te.label.classList.add("checkbox-disabled"))})),H=(0,u.Z)("btn-primary btn-color-primary",{text:"Login.Next"}),H.style.visibility="hidden";const ne=e=>{e&&(0,k.d)(e);const t=(0,x.Z)([H,B],!0);(0,T.Z)(H,(0,g.i18n)("PleaseWait")),(0,a.y7)(H);let o=Y.value;s.Z.invokeApi("auth.sendCode",{phone_number:o,api_id:m.Z.id,api_hash:m.Z.hash,settings:{_:"codeSettings"}}).then((e=>{n.e(392).then(n.bind(n,6392)).then((t=>t.default.mount(Object.assign(e,{phone_number:o}))))})).catch((e=>{t(),"PHONE_NUMBER_INVALID"===e.type?(Y.setError(),(0,T.Z)(Y.label,(0,g.i18n)("Login.PhoneLabelInvalid")),ee.classList.add("error"),(0,T.Z)(H,(0,g.i18n)("Login.Next"))):(console.error("auth.sendCode error:",e),H.innerText=e.type)}))};(0,S.fc)(H,ne),B=(0,u.Z)("btn-primary btn-secondary btn-primary-transparent primary",{text:"Login.QR.Login"}),B.addEventListener("click",(()=>{_.default.mount()})),U.append(W.container,Y.container,te.label,H,B);const ae=document.createElement("h4");ae.classList.add("text-center"),(0,g._i18n)(ae,"Login.Title");const oe=document.createElement("div");oe.classList.add("subtitle","text-center"),(0,g._i18n)(oe,"Login.StartText"),R.pageEl.querySelector(".container").append(ae,oe,U),h.IS_TOUCH_SUPPORTED||setTimeout((()=>{ee.focus()}),0),(0,w.Z)(U),s.Z.invokeApi("help.getNearestDc").then((e=>{var t;const n=A.Z.getFromCache("langPack");n&&!(null===(t=n.countries)||void 0===t?void 0:t.hash)&&g.default.getLangPack(n.lang_code).then((()=>{(0,I.Z)(ee,"input")}));const a=new Set([1,2,3,4,5]),o=[e.this_dc];let i;return e.nearest_dc!==e.this_dc&&(i=s.Z.getNetworker(e.nearest_dc).then((()=>{o.push(e.nearest_dc)}))),(i||Promise.resolve()).then((()=>{o.forEach((e=>{a.delete(e)}));const e=[...a],t=()=>{return n=void 0,a=void 0,i=function*(){const n=e.shift();if(!n)return;const a=`dc${n}_auth_key`;if(yield C.Z.get(a))return t();setTimeout((()=>{s.Z.getNetworker(n).finally(t)}),3e3)},new((o=void 0)||(o=Promise))((function(e,t){function s(e){try{r(i.next(e))}catch(e){t(e)}}function c(e){try{r(i.throw(e))}catch(e){t(e)}}function r(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(s,c)}r((i=i.apply(n,a||[])).next())}));var n,a,o,i};t()})),e})).then((e=>{W.value.length||Y.value.length||Q(r.get(e.country)[0])}))}),(()=>{H&&((0,T.Z)(H,(0,g.i18n)("Login.Next")),(0,v.ripple)(H,void 0,void 0,!0),H.removeAttribute("disabled")),B&&B.removeAttribute("disabled"),i.default.pushToState("authState",{_:"authStateSignIn"})})),j=R}}]);
//# sourceMappingURL=810.bd27b2cf5e0477ce915d.chunk.js.map