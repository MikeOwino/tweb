"use strict";(this.webpackChunktweb=this.webpackChunktweb||[]).push([[458],{503:(t,e,i)=>{i.d(e,{I:()=>d,Z:()=>c});var n=i(6669),s=i(8763),a=i(3735),l=i(1293),o=i(4727),r=i(8598),h=i(9099);let u=()=>{document.addEventListener("paste",(t=>{if(!(0,s.Z)(t.target,'contenteditable="true"'))return;let e,i;t.preventDefault();let n=(t.originalEvent||t).clipboardData.getData("text/plain"),l=!0,o=(t.originalEvent||t).clipboardData.getData("text/html");if(o.trim()){o=o.replace(/<style([\s\S]*)<\/style>/,""),o=o.replace(/<!--([\s\S]*)-->/,"");const t=o.match(/<body>([\s\S]*)<\/body>/);t&&(o=t[1].trim());let s=document.createElement("span");s.innerHTML=o;let h=s.firstChild;for(;h;){let t=h.nextSibling;3===h.nodeType&&(h.nodeValue.trim()||h.remove()),h=t}const u=(0,a.Z)(s,!0);if(u.value.replace(/\s/g,"").length===n.replace(/\s/g,"").length){e=u.value,i=u.entities,l=!1;let t=r.Z.parseEntities(e);t=t.filter((t=>"messageEntityEmoji"===t._||"messageEntityLinebreak"===t._)),r.Z.mergeEntities(i,t)}}l&&(e=n,i=r.Z.parseEntities(e),i=i.filter((t=>"messageEntityEmoji"===t._||"messageEntityLinebreak"===t._))),e=r.Z.wrapDraftText(e,{entities:i}),window.document.execCommand("insertHTML",!1,e)})),u=null};var d;!function(t){t[t.Neutral=0]="Neutral",t[t.Valid=1]="Valid",t[t.Error=2]="Error"}(d||(d={}));const c=class{constructor(t={}){this.options=t,this.container=document.createElement("div"),this.container.classList.add("input-field"),this.required=t.required,this.validate=t.validate,void 0!==t.maxLength&&void 0===t.showLengthOn&&(t.showLengthOn=Math.min(40,Math.round(t.maxLength/3)));const{placeholder:e,maxLength:i,showLengthOn:n,name:s,plainText:r,canBeEdited:h=!0}=t;let d,c,p=t.label||t.labelText;if(r)this.container.innerHTML=`\n      <input type="text" ${s?`name="${s}"`:""} autocomplete="off" ${p?'required=""':""} class="input-field-input">\n      `,d=this.container.firstElementChild;else{u&&u(),this.container.innerHTML=`\n      <div contenteditable="${String(!!h)}" class="input-field-input"></div>\n      `,d=this.container.firstElementChild;const e=new MutationObserver((()=>{c&&c()}));d.addEventListener("input",(()=>{(0,l.Z)(d)&&(d.innerHTML=""),this.inputFake&&(this.inputFake.innerHTML=d.innerHTML,this.onFakeInput())})),e.observe(d,{characterData:!0,childList:!0,subtree:!0}),t.animate&&(d.classList.add("scrollable","scrollable-y"),this.inputFake=document.createElement("div"),this.inputFake.setAttribute("contenteditable","true"),this.inputFake.className=d.className+" input-field-input-fake")}if(d.setAttribute("dir","auto"),e&&((0,o._i18n)(d,e,void 0,"placeholder"),this.inputFake&&(0,o._i18n)(this.inputFake,e,void 0,"placeholder")),p||e){const t=document.createElement("div");t.classList.add("input-field-border"),this.container.append(t)}if(p&&(this.label=document.createElement("label"),this.setLabel(),this.container.append(this.label)),i){const t=this.container.lastElementChild;let e=!1;c=()=>{const s=d.classList.contains("error"),l=r?d.value.length:[...(0,a.Z)(d,!1).value].length,o=i-l,h=o<0;d.classList.toggle("error",h),h||o<=n?(this.setLabel(),t.append(` (${i-l})`),e||(e=!0)):(s&&!h||e)&&(this.setLabel(),e=!1)},d.addEventListener("input",c)}this.input=d}select(){this.value&&(this.options.plainText?this.input.select():function(t){const e=document.createRange();e.selectNodeContents(t);const i=window.getSelection();i.removeAllRanges(),i.addRange(e)}(this.input))}setLabel(){this.label.textContent="",this.options.labelText?this.label.innerHTML=this.options.labelText:this.label.append((0,o.i18n)(this.options.label,this.options.labelOptions))}onFakeInput(t=!0){const{scrollHeight:e}=this.inputFake,i=+this.input.style.height.replace("px","");if(i===e)return;const n=Math.round(50*Math.log(Math.abs(e-i)));this.input.style.transitionDuration=`${n}ms`,t&&(this.input.style.height=e?e+"px":"");const s="is-changing-height";(0,h.Z)(this.input,s,!0,n,(()=>{this.input.classList.remove(s)}))}get value(){return this.options.plainText?this.input.value:(0,a.Z)(this.input,!1).value}set value(t){this.setValueSilently(t,!1),(0,n.Z)(this.input,"input")}setValueSilently(t,e=!0){this.options.plainText?this.input.value=t:(this.input.innerHTML=t,this.inputFake&&(this.inputFake.innerHTML=t,e&&this.onFakeInput()))}isChanged(){return this.value!==this.originalValue}isValid(){return!this.input.classList.contains("error")&&(!this.validate||this.validate())&&(!this.required||!(0,l.Z)(this.input))}isValidToChange(){return this.isValid()&&this.isChanged()}setDraftValue(t="",e=!1){this.options.plainText||(t=r.Z.wrapDraftText(t)),e?this.setValueSilently(t,!1):this.value=t}setOriginalValue(t="",e=!1){this.originalValue=t,this.setDraftValue(t,e)}setState(t,e){e&&(this.label.textContent="",this.label.append((0,o.i18n)(e,this.options.labelOptions))),this.input.classList.toggle("error",!!(t&d.Error)),this.input.classList.toggle("valid",!!(t&d.Valid))}setError(t){this.setState(d.Error,t)}}},9099:(t,e,i)=>{i.d(e,{Z:()=>a});var n=i(3512);const s=(t,e,i,a,l,o)=>{const{timeout:r,raf:h}=t.dataset;if(void 0!==r&&clearTimeout(+r),void 0!==h&&(window.cancelAnimationFrame(+h),o||delete t.dataset.raf),o&&n.default.settings.animationsEnabled&&a)return void(t.dataset.raf=""+window.requestAnimationFrame((()=>{delete t.dataset.raf,s(t,e,i,a,l,o-1)})));i&&e&&t.classList.add(e);const u=()=>{delete t.dataset.timeout,!i&&e&&t.classList.remove("backwards",e),t.classList.remove("animating"),l&&l()};if(!n.default.settings.animationsEnabled||!a)return t.classList.remove("animating","backwards"),void u();t.classList.add("animating"),t.classList.toggle("backwards",!i),t.dataset.timeout=""+setTimeout(u,a)},a=s},8763:(t,e,i)=>{function n(t,e){return t.closest(`[${e}]`)}i.d(e,{Z:()=>n})},9041:(t,e,i)=>{i.d(e,{Z:()=>a,o:()=>n});const n={bold:{match:'[style*="bold"], [style*="font-weight: 700"], [style*="font-weight: 600"], [style*="font-weight:700"], [style*="font-weight:600"], b, strong',entityName:"messageEntityBold"},underline:{match:'[style*="underline"], u, ins',entityName:"messageEntityUnderline"},italic:{match:'[style*="italic"], i, em',entityName:"messageEntityItalic"},monospace:{match:'[style*="monospace"], [face="monospace"], pre',entityName:"messageEntityPre"},strikethrough:{match:'[style*="line-through"], strike, del, s',entityName:"messageEntityStrike"},link:{match:"A:not(.follow)",entityName:"messageEntityTextUrl"},mentionName:{match:"A.follow",entityName:"messageEntityMentionName"},spoiler:{match:'[style*="spoiler"]',entityName:"messageEntitySpoiler"}},s=new Set(["DIV","P","BR","LI","SECTION","H6","H5","H4","H3","H2","H1","TR"]);function a(t,e,i,l,o,r,h={offset:0}){if(3===t.nodeType){let e=t.nodeValue;if(l===t?i.push(e.substr(0,o)+""+e.substr(o)):i.push(e),r&&e.length&&t.parentNode){const i=t.parentElement;for(const t in n){const s=n[t],a=i.closest(s.match+", [contenteditable]");null===(null==a?void 0:a.getAttribute("contenteditable"))&&("messageEntityTextUrl"===s.entityName?r.push({_:s.entityName,url:a.href,offset:h.offset,length:e.length}):"messageEntityMentionName"===s.entityName?r.push({_:s.entityName,offset:h.offset,length:e.length,user_id:a.dataset.follow.toUserId()}):r.push({_:s.entityName,offset:h.offset,length:e.length}))}}return void(h.offset+=e.length)}if(1!==t.nodeType)return;const u=l===t,d=s.has(t.tagName);if(d&&i.length)e.push(i.join("")),i.splice(0,i.length),++h.offset;else if(t instanceof HTMLImageElement){const e=t.alt;e&&(i.push(e),h.offset+=e.length)}u&&!o&&i.push("");const c=t.matches('[style*="table-cell"], th, td'),p=null==r?void 0:r.length;let m=t.firstChild;for(;m;)a(m,e,i,l,o,r,h),m=m.nextSibling;if(u&&o&&i.push(""),c&&t.nextSibling&&(i.push(" "),++h.offset,void 0!==p))for(let t=p,e=r.length;t<e;++t)++r[t].length;const g=i.length;d&&g&&(e.push(i.join("")),i.splice(0,g),++h.offset),g&&"P"===t.tagName&&t.nextSibling&&(e.push(""),++h.offset)}},3735:(t,e,i)=>{i.d(e,{Z:()=>l});var n=i(410),s=i(8598),a=i(9041);function l(t,e=!0){const i=[],n=[],l=e?[]:void 0;(0,a.Z)(t,i,n,void 0,void 0,l),n.length&&i.push(n.join(""));let o=i.join("\n");return o=o.replace(/\u00A0/g," "),(null==l?void 0:l.length)&&(s.Z.combineSameEntities(l),s.Z.sortEntities(l)),{value:o,entities:l}}n.GO.getRichValue=l},1293:(t,e,i)=>{i.d(e,{Z:()=>s});var n=i(3735);function s(t){return t.hasAttribute("contenteditable")||"INPUT"!==t.tagName?!(0,n.Z)(t,!1).value.trim():!t.value.trim()}},5565:(t,e,i)=>{function n(t,e){if("string"==typeof e)return void(t.innerHTML=e);const i=t.firstChild;i?t.lastChild===i?i.replaceWith(e):(t.textContent="",t.append(e)):t.append(e)}i.d(e,{Z:()=>n})}}]);
//# sourceMappingURL=458.79a9471a7327d7c9cca1.chunk.js.map